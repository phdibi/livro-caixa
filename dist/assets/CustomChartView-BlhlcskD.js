import{r as m,n as S,m as M,j as e,f as j}from"./index-Dj2qBV3V.js";import{R as E,o as O,T as z}from"./CategoricalChart-DhZrjnYR.js";import{P as A,a as F}from"./PieChart-C25fpqmq.js";import{B as L,C as K,X as P,Y as J,a as V}from"./BarChart-Ce5TWLsP.js";const R=s=>s>=1e6?`R$ ${(s/1e6).toFixed(1)}M`:s>=1e3?`R$ ${(s/1e3).toFixed(1)}K`:j(s),$=["#6366f1","#8b5cf6","#ec4899","#f43f5e","#f97316","#eab308","#22c55e","#14b8a6","#06b6d4","#3b82f6","#a855f7","#d946ef"],Y=({accounts:s,selectedAccountIds:n,onChange:r})=>{const[g,x]=m.useState(!1),h=m.useRef(null);m.useEffect(()=>{const l=c=>{h.current&&!h.current.contains(c.target)&&x(!1)};return document.addEventListener("mousedown",l),()=>document.removeEventListener("mousedown",l)},[h]);const d=l=>{const c=n.includes(l)?n.filter(p=>p!==l):[...n,l];r(c)};return e.jsxs("div",{className:"relative",ref:h,children:[e.jsx("button",{onClick:()=>x(!g),className:"w-full p-2 border rounded-md dark:bg-gray-700 dark:border-gray-600 dark:text-white text-left text-sm",children:n.length===0?"Todas as Contas":`${n.length} conta(s)`}),g&&e.jsxs("div",{className:"absolute z-10 w-full mt-1 bg-white dark:bg-gray-700 border dark:border-gray-600 rounded-md shadow-lg max-h-60 overflow-auto",children:[e.jsx("div",{className:"p-2 cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-600 text-sm",onClick:()=>r([]),children:"Todas as Contas"}),s.map(l=>e.jsxs("div",{className:"p-2 flex items-center text-sm",children:[e.jsx("input",{type:"checkbox",checked:n.includes(l.id),onChange:()=>d(l.id),className:"mr-2"}),e.jsxs("span",{className:"truncate",children:[l.number," - ",l.name]})]},l.id))]})]})},G=({data:s,total:n})=>{const[r,g]=m.useState(!1),x=r?s:s.slice(0,6),h=s.length>6;return e.jsxs("div",{className:"flex flex-col gap-1.5 text-xs max-h-[280px] overflow-y-auto pr-1",children:[x.map((d,l)=>{const c=n>0?(d.value/n*100).toFixed(1):"0";return e.jsxs("div",{className:"flex items-center gap-2 py-1",children:[e.jsx("span",{className:"w-3 h-3 rounded-sm flex-shrink-0",style:{backgroundColor:d.color}}),e.jsx("span",{className:"flex-1 truncate text-gray-700 dark:text-gray-300",title:d.name,children:d.name}),e.jsxs("span",{className:"text-gray-500 dark:text-gray-400 whitespace-nowrap",children:[c,"%"]}),e.jsx("span",{className:"font-medium text-gray-800 dark:text-gray-200 whitespace-nowrap",children:R(d.value)})]},l)}),h&&e.jsx("button",{onClick:()=>g(!r),className:"text-indigo-600 dark:text-indigo-400 hover:underline text-left mt-1",children:r?"← Mostrar menos":`+${s.length-6} mais...`})]})},W=({active:s,payload:n})=>{if(s&&n&&n.length){const r=n[0].payload;return e.jsxs("div",{className:"bg-gray-900 text-white px-3 py-2 rounded-lg shadow-lg text-sm",children:[e.jsx("p",{className:"font-medium",children:r.name}),e.jsx("p",{className:"text-gray-300",children:j(r.value)})]})}return null},U=({transactions:s,accounts:n})=>{const[r,g]=m.useState("Saidas"),[x,h]=m.useState("conta"),[d,l]=m.useState([]),[c,p]=m.useState("pizza"),{chartData:y,total:v}=m.useMemo(()=>{const o=d.length>0?s.filter(a=>n.find(t=>t.number===a.accountNumber&&d.includes(t.id))):s,i={};if(x==="mes"){const a=["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"];o.forEach(t=>{const w=new Date(t.date+"T00:00:00"),N=w.getMonth(),C=w.getFullYear(),b=`${C}-${String(N).padStart(2,"0")}`;i[b]||(i[b]={name:`${a[N]}/${C.toString().slice(-2)}`,Entrada:0,Saida:0}),S(t)?i[b].Entrada+=t.amount:M(t)&&(i[b].Saida+=t.amount)})}else o.forEach(a=>{const t=a.accountName;i[t]||(i[t]={name:t,Entrada:0,Saida:0}),S(a)?i[t].Entrada+=a.amount:M(a)&&(i[t].Saida+=a.amount)});let f=Object.values(i);x==="mes"&&(f=Object.entries(i).sort(([a],[t])=>a.localeCompare(t)).map(([,a])=>a));let u;r==="Entradas"?u=f.map(a=>({name:a.name,value:a.Entrada})).filter(a=>a.value>0):r==="Saidas"?u=f.map(a=>({name:a.name,value:a.Saida})).filter(a=>a.value>0):u=f.map(a=>({name:a.name,value:a.Entrada-a.Saida})),c==="pizza"&&u.sort((a,t)=>Math.abs(t.value)-Math.abs(a.value));const B=u.reduce((a,t)=>a+Math.abs(t.value),0);return{chartData:u,total:B}},[s,n,r,x,d,c]),k=y.map((o,i)=>({...o,color:$[i%$.length]})),T=`${r} por ${x==="conta"?"Conta":"Mês"}`,D=r==="Entradas"?"#22c55e":r==="Saidas"?"#ef4444":"#3b82f6";return e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 sm:p-6 rounded-lg shadow",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 mb-4",children:[e.jsx("h3",{className:"font-semibold text-gray-800 dark:text-gray-200 text-lg",children:T}),e.jsxs("div",{className:"flex items-center gap-1 bg-gray-100 dark:bg-gray-700 rounded-lg p-1",children:[e.jsx("button",{onClick:()=>p("pizza"),className:`px-3 py-1.5 text-xs font-medium rounded-md transition-colors ${c==="pizza"?"bg-white dark:bg-gray-600 text-gray-900 dark:text-white shadow-sm":"text-gray-600 dark:text-gray-400"}`,children:"Pizza"}),e.jsx("button",{onClick:()=>p("barras"),className:`px-3 py-1.5 text-xs font-medium rounded-md transition-colors ${c==="barras"?"bg-white dark:bg-gray-600 text-gray-900 dark:text-white shadow-sm":"text-gray-600 dark:text-gray-400"}`,children:"Barras"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-600 dark:text-gray-400 mb-1 block",children:"Métrica"}),e.jsxs("select",{value:r,onChange:o=>g(o.target.value),className:"w-full p-2 text-sm border rounded-md dark:bg-gray-700 dark:border-gray-600 dark:text-white",children:[e.jsx("option",{value:"Saidas",children:"Saídas"}),e.jsx("option",{value:"Entradas",children:"Entradas"}),e.jsx("option",{value:"Margem",children:"Margem"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-600 dark:text-gray-400 mb-1 block",children:"Agrupar por"}),e.jsxs("select",{value:x,onChange:o=>h(o.target.value),className:"w-full p-2 text-sm border rounded-md dark:bg-gray-700 dark:border-gray-600 dark:text-white",children:[e.jsx("option",{value:"conta",children:"Conta"}),e.jsx("option",{value:"mes",children:"Mês"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-600 dark:text-gray-400 mb-1 block",children:"Filtrar Contas"}),e.jsx(Y,{accounts:n,selectedAccountIds:d,onChange:l})]})]}),y.length>0?c==="pizza"?e.jsxs("div",{className:"flex flex-col lg:flex-row gap-6 items-center lg:items-start",children:[e.jsx("div",{className:"w-full lg:w-1/2 flex justify-center",children:e.jsx("div",{className:"w-[280px] h-[280px] sm:w-[320px] sm:h-[320px]",children:e.jsx(E,{width:"100%",height:"100%",children:e.jsxs(A,{children:[e.jsx(F,{data:k,cx:"50%",cy:"50%",innerRadius:60,outerRadius:100,paddingAngle:2,dataKey:"value",stroke:"none",children:k.map((o,i)=>e.jsx(O,{fill:o.color},`cell-${i}`))}),e.jsx(z,{content:e.jsx(W,{})})]})})})}),e.jsxs("div",{className:"w-full lg:w-1/2 flex flex-col gap-4",children:[e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4 text-center lg:text-left",children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 uppercase tracking-wide",children:"Total"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:j(v)})]}),e.jsx(G,{data:k,total:v})]})]}):e.jsx(E,{width:"100%",height:300,children:e.jsxs(L,{data:y,margin:{top:5,right:20,left:10,bottom:5},children:[e.jsx(K,{strokeDasharray:"3 3",stroke:"rgba(128, 128, 128, 0.2)"}),e.jsx(P,{dataKey:"name",stroke:"#9ca3af",tick:{fontSize:11},interval:0,angle:-45,textAnchor:"end",height:80}),e.jsx(J,{stroke:"#9ca3af",tickFormatter:o=>R(o),width:70}),e.jsx(z,{contentStyle:{backgroundColor:"#1f2937",border:"none",borderRadius:"8px"},labelStyle:{color:"#d1d5db"},formatter:o=>j(o)}),e.jsx(V,{dataKey:"value",fill:D,name:r,radius:[4,4,0,0]})]})}):e.jsx("div",{className:"h-[300px] flex items-center justify-center text-gray-500 dark:text-gray-400",children:e.jsxs("div",{className:"text-center",children:[e.jsx("svg",{className:"w-12 h-12 mx-auto mb-2 opacity-50",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),e.jsx("p",{children:"Nenhum dado para exibir"})]})})]})};export{U as default};
