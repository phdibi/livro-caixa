import{s as $,b as ee,u as ie,g as ce,d as me,r as c,R as h,j as e,I as w,T as G,c as ae,e as _,p as ue,h as xe}from"./index-CX3uHzjl.js";const ge=["image/jpeg","image/png","image/gif","image/webp","application/pdf"],K=10*1024*1024;function te(d){return ge.includes(d.type)?d.size>K?{code:"file-too-large",message:`Arquivo muito grande. Máximo: ${K/1024/1024}MB.`}:null:{code:"invalid-type",message:"Tipo de arquivo não permitido. Use: JPEG, PNG, GIF, WebP ou PDF."}}function pe(d){const m=Date.now(),g=Math.random().toString(36).substring(2,8),n=d.split(".").pop()||"bin";return`${d.replace(/\.[^/.]+$/,"").replace(/[^a-zA-Z0-9]/g,"_").substring(0,50)}_${m}_${g}.${n}`}async function he(d,m,g){if(!$)throw{code:"storage-not-configured",message:"Firebase Storage não está configurado."};const n=te(d);if(n)throw n;try{const u=pe(d.name),E=`receipts/${m}/${g}/${u}`,M=ee($,E),b=await ie(M,d,{contentType:d.type,customMetadata:{originalName:d.name,transactionId:g,uploadedBy:m}});return{url:await ce(b.ref),filename:d.name,uploadedAt:Date.now()}}catch(u){throw console.error("Erro ao fazer upload:",u),{code:"upload-failed",message:"Falha ao enviar arquivo. Tente novamente."}}}async function be(d){if(!(!$||!d))try{const m=ee($,d);await me(m)}catch(m){console.warn("Erro ao excluir comprovante (pode já ter sido excluído):",m)}}function ye(d){var n;const m=["jpg","jpeg","png","gif","webp"],g=((n=d.split(".").pop())==null?void 0:n.toLowerCase())||"";return m.includes(g)}function ke(d){return d.toLowerCase().endsWith(".pdf")}const ve=({transactionId:d,userId:m,currentReceiptUrl:g,currentReceiptFilename:n,receiptStatus:u,onUploadComplete:E,onDeleteComplete:M,onStatusChange:b,disabled:k=!1})=>{const[y,r]=c.useState(!1),[p,v]=c.useState(0),[T,D]=c.useState(null),[q,U]=c.useState(!1),P=c.useRef(null),R=c.useCallback(async l=>{D(null);const f=te(l);if(f){D(f.message);return}r(!0),v(0);const C=setInterval(()=>{v(V=>Math.min(V+10,90))},100);try{const V=await he(l,m,d);clearInterval(C),v(100),E(V),b(h.ATTACHED),setTimeout(()=>{v(0)},500)}catch(V){clearInterval(C),v(0),D(V.message||"Erro ao enviar arquivo")}finally{r(!1)}},[m,d,E,b]),I=l=>{var C;const f=(C=l.target.files)==null?void 0:C[0];f&&R(f),l.target.value=""},F=l=>{l.preventDefault(),!k&&!y&&U(!0)},B=l=>{l.preventDefault(),U(!1)},S=l=>{var C;if(l.preventDefault(),U(!1),k||y)return;const f=(C=l.dataTransfer.files)==null?void 0:C[0];f&&R(f)},O=async()=>{if(!(!g||!window.confirm("Tem certeza que deseja excluir o comprovante?")))try{await be(g),M(),b(h.HAS_BUT_NOT_ATTACHED)}catch{D("Erro ao excluir comprovante")}},x=()=>{g&&window.open(g,"_blank")};return g&&u===h.ATTACHED?e.jsx("div",{className:"border border-green-200 dark:border-green-800 rounded-lg p-3 bg-green-50 dark:bg-green-900/20",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[n&&ye(n)?e.jsx("svg",{className:"w-5 h-5 text-green-600 dark:text-green-400 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}):ke(n||"")?e.jsx("svg",{className:"w-5 h-5 text-red-600 dark:text-red-400 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"})}):e.jsx("svg",{className:"w-5 h-5 text-gray-600 dark:text-gray-400 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),e.jsx("span",{className:"text-sm text-green-700 dark:text-green-300 truncate",children:n||"Comprovante anexado"})]}),e.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[e.jsx("button",{onClick:x,className:"p-1.5 text-green-600 hover:bg-green-100 dark:hover:bg-green-800 rounded",title:"Ver comprovante",children:e.jsxs("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})}),!k&&e.jsx("button",{onClick:O,className:"p-1.5 text-red-600 hover:bg-red-100 dark:hover:bg-red-900/40 rounded",title:"Excluir comprovante",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]})}):e.jsxs("div",{className:"space-y-2",children:[e.jsx("input",{ref:P,type:"file",accept:"image/jpeg,image/png,image/gif,image/webp,application/pdf",onChange:I,className:"hidden",disabled:k||y}),e.jsx("div",{onDragOver:F,onDragLeave:B,onDrop:S,onClick:()=>{var l;return!k&&!y&&((l=P.current)==null?void 0:l.click())},className:`
          border-2 border-dashed rounded-lg p-4 text-center cursor-pointer
          transition-colors duration-200
          ${q?"border-indigo-500 bg-indigo-50 dark:bg-indigo-900/20":"border-gray-300 dark:border-gray-600 hover:border-indigo-400 dark:hover:border-indigo-500"}
          ${k||y?"opacity-50 cursor-not-allowed":""}
        `,children:y?e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2",children:e.jsx("div",{className:"bg-indigo-600 h-2 rounded-full transition-all duration-200",style:{width:`${p}%`}})}),e.jsx("p",{className:"text-sm text-gray-500",children:"Enviando..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"mx-auto h-8 w-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),e.jsx("p",{className:"mt-1 text-sm text-gray-600 dark:text-gray-400",children:"Arraste um arquivo ou clique para selecionar"}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-500",children:"JPEG, PNG, GIF, WebP ou PDF (máx. 10MB)"})]})}),T&&e.jsx("p",{className:"text-sm text-red-600 dark:text-red-400",children:T})]})},J=()=>ae(new Date),je=({isOpen:d,onClose:m,onSave:g,transactionToEdit:n,accounts:u,transactions:E,userId:M})=>{const b=c.useMemo(()=>({number:u.length>0?u[0].number:0,name:u.length>0?u[0].name:""}),[u]),k=c.useCallback(()=>({date:J(),type:G.SAIDA,accountNumber:b.number,accountName:b.name,description:"",quantity:1,unitValue:0,amount:0,payee:"",paymentMethod:"pix",notes:"",receiptStatus:h.NONE,irCategory:w.NAO_DEDUTIVEL,irNotes:"",isContaTiti:!1,receiptUrl:void 0,receiptFilename:void 0,receiptUploadedAt:void 0}),[b]),y=c.useCallback(()=>({id:_(),accountNumber:b.number,accountName:b.name,description:"",quantity:1,unitValue:0,amount:0}),[b]),[r,p]=c.useState(k()),[v,T]=c.useState(1),[D,q]=c.useState(J()),[U,P]=c.useState("single"),[R]=c.useState((n==null?void 0:n.id)||_()),[I,F]=c.useState(!1),[B,S]=c.useState([y()]),O=!!(n!=null&&n.seriesId);if(c.useEffect(()=>{if(d)if(n){const a={...k(),...n};if((!a.unitValue||a.unitValue===0)&&a.amount>0&&(a.quantity=1,a.unitValue=a.amount),n.seriesId){const t=E.filter(o=>o.seriesId===n.seriesId);T(t.length||1);const A=[...t].sort((o,j)=>o.date.localeCompare(j.date))[0]??n;q(A.date)}else T(1),q(n.date);p(a);const s=n.items;s&&s.length>0?(F(!0),S(s.map(t=>({id:t.id||_(),accountNumber:t.accountNumber,accountName:t.accountName,description:t.description,quantity:t.quantity,unitValue:t.unitValue,amount:t.amount})))):(F(!1),S([y()]))}else{const a=k();p(a),T(1),q(a.date),P("single"),F(!1),S([y()])}},[d,n,E,u]),c.useEffect(()=>{var t;if(I)return;const a=r.quantity||0,s=r.unitValue||0;((t=document.activeElement)==null?void 0:t.getAttribute("name"))!=="amount"&&p(L=>({...L,amount:a*s}))},[r.quantity,r.unitValue,I]),!d)return null;const x=a=>{const{name:s,value:t}=a.target,L=a.target.checked;if(s==="isContaTiti"){p(o=>({...o,isContaTiti:L}));return}if(s==="accountNumber"){const o=parseInt(t,10),j=u.find(i=>i.number===o);p(i=>({...i,accountNumber:o,accountName:(j==null?void 0:j.name)||""}));return}if(s==="receiptStatus"){p(o=>({...o,receiptStatus:t}));return}if(s==="irCategory"){p(o=>({...o,irCategory:t}));return}let A=t;["amount","quantity","unitValue"].includes(s)&&(A=parseFloat(t)||0),p(o=>({...o,[s]:A}))},l=(a,s,t)=>{S(L=>L.map(A=>{if(A.id!==a)return A;const o={...A};switch(s){case"accountNumber":{const j=parseInt(t,10),i=u.find(N=>N.number===j);o.accountNumber=j,o.accountName=(i==null?void 0:i.name)||"";break}case"quantity":o.quantity=parseFloat(t)||0;break;case"unitValue":o.unitValue=parseFloat(t)||0;break;case"amount":o.amount=parseFloat(t)||0;break;case"description":o.description=String(t);break}return(s==="quantity"||s==="unitValue")&&(o.amount=o.quantity*o.unitValue),o}))},f=()=>S(a=>[...a,y()]),C=a=>S(s=>s.length===1?[y()]:s.filter(t=>t.id!==a)),V=a=>{if(a.preventDefault(),I&&!O){const t=B.filter(i=>i.description.trim()!==""||i.amount>0);if(t.length===0){alert("Adicione pelo menos um item na nota.");return}const L=_(),o=v>1&&D||r.date||J(),j=ue(o);if(Number.isNaN(j.getTime())){alert("Data da 1ª parcela inválida. Verifique o campo de data do lançamento.");return}t.forEach(i=>{const N=Math.max(1,v),Q=N>1?_():void 0,se=typeof i.amount=="number"&&!isNaN(i.amount)?i.amount:(i.quantity||0)*(i.unitValue||0),z=Math.round(se*100),X=N>0?Math.floor(z/N):z;let ne=z-X*N;for(let H=0;H<N;H++){const oe=xe(j,H);let Z=X;H===N-1&&(Z+=ne);const de=Z/100,Y={...r,id:_(),date:ae(oe),accountNumber:i.accountNumber,accountName:i.accountName,description:N>1?`${i.description} (${H+1}/${N})`:i.description,quantity:i.quantity,unitValue:i.unitValue,amount:de,invoiceId:L},le=N>1&&Q?{...Y,seriesId:Q}:Y;g({transaction:le,installmentsCount:1})}}),m();return}const s={...r,id:R,date:r.date};g({transaction:s,updateScope:O?U:void 0,installmentsCount:v,firstInstallmentDate:D}),m()},W=!O,re=B.reduce((a,s)=>a+s.amount,0);return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-start sm:items-center p-2 sm:p-4 overflow-y-auto",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl w-full max-w-2xl p-4 sm:p-6 my-4 sm:my-8",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-900 dark:text-white",children:[n?"Editar":"Adicionar"," Lançamento"]}),e.jsxs("label",{className:"flex items-center text-xs sm:text-sm text-gray-700 dark:text-gray-300",children:[e.jsx("input",{type:"checkbox",checked:I,onChange:a=>F(a.target.checked&&W),disabled:!W,className:"mr-2"}),"Modo nota fiscal"]})]}),e.jsx("div",{className:"mb-4",children:e.jsxs("label",{className:"flex items-center text-sm font-medium text-amber-600 dark:text-amber-400",children:[e.jsx("input",{type:"checkbox",name:"isContaTiti",checked:!!r.isContaTiti,onChange:x,className:"mr-2 rounded border-gray-300 text-amber-600 shadow-sm focus:border-amber-300 focus:ring focus:ring-amber-200 focus:ring-opacity-50"}),"Conta Titi (Ocultar do fluxo/gráficos)"]})}),e.jsxs("form",{onSubmit:V,className:"space-y-4 max-h-[80vh] overflow-y-auto pr-1",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-700 dark:text-gray-300",children:"Data"}),e.jsx("input",{type:"date",name:"date",value:r.date,onChange:x,className:"mt-1 w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-700 dark:text-gray-300",children:"Tipo"}),e.jsxs("select",{name:"type",value:r.type,onChange:x,className:"mt-1 w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white",children:[e.jsx("option",{value:G.ENTRADA,children:"Entrada"}),e.jsx("option",{value:G.SAIDA,children:"Saída"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-700 dark:text-gray-300",children:"Fornecedor/Comprador"}),e.jsx("input",{type:"text",name:"payee",value:r.payee,onChange:x,placeholder:"Nome do fornecedor ou comprador",className:"mt-1 w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white"})]}),!I&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-700 dark:text-gray-300",children:"Conta"}),e.jsx("select",{name:"accountNumber",value:r.accountNumber,onChange:x,className:"mt-1 w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white",children:u.map(a=>e.jsxs("option",{value:a.number,children:[a.number," - ",a.name]},a.id))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-700 dark:text-gray-300",children:"Histórico"}),e.jsx("input",{type:"text",name:"description",value:r.description,onChange:x,className:"mt-1 w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white"})]})]}),I?e.jsx(e.Fragment,{children:e.jsxs("div",{className:"border-2 border-amber-400 dark:border-amber-600 rounded-md p-3 bg-amber-50 dark:bg-amber-900/20 space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsxs("p",{className:"text-xs font-semibold text-amber-700 dark:text-amber-300 uppercase flex items-center",children:[e.jsx("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Itens da Nota Fiscal"]}),e.jsxs("span",{className:"text-xs text-amber-600 dark:text-amber-400",children:["Total:"," ",e.jsx("strong",{children:re.toLocaleString("pt-BR",{style:"currency",currency:"BRL"})})]})]}),B.map((a,s)=>e.jsxs("div",{className:"border rounded-md p-2 mb-2 bg-white dark:bg-gray-800",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsxs("span",{className:"text-xs font-medium text-gray-500 dark:text-gray-400",children:["Item ",s+1]}),e.jsx("button",{type:"button",onClick:()=>C(a.id),className:"text-xs text-red-600 dark:text-red-400 hover:text-red-800",children:"Remover"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2 mb-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-700 dark:text-gray-300",children:"Conta"}),e.jsx("select",{value:a.accountNumber,onChange:t=>l(a.id,"accountNumber",t.target.value),className:"mt-1 w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white text-sm",children:u.map(t=>e.jsxs("option",{value:t.number,children:[t.number," - ",t.name]},t.id))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-700 dark:text-gray-300",children:"Descrição do item"}),e.jsx("input",{type:"text",value:a.description,onChange:t=>l(a.id,"description",t.target.value),placeholder:"Ex: Ração, Medicamento...",className:"mt-1 w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white text-sm"})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-700 dark:text-gray-300",children:"Qtde"}),e.jsx("input",{type:"number",step:"any",value:a.quantity,onChange:t=>l(a.id,"quantity",t.target.value),className:"mt-1 w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-700 dark:text-gray-300",children:"Valor unit."}),e.jsx("input",{type:"number",step:"any",value:a.unitValue,onChange:t=>l(a.id,"unitValue",t.target.value),className:"mt-1 w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-700 dark:text-gray-300",children:"Valor total"}),e.jsx("input",{type:"number",step:"any",value:a.amount,onChange:t=>l(a.id,"amount",t.target.value),className:"mt-1 w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white text-sm font-semibold"})]})]})]},a.id)),e.jsxs("button",{type:"button",onClick:f,className:"text-sm text-amber-700 dark:text-amber-400 hover:text-amber-900 flex items-center",children:[e.jsx("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Adicionar item"]})]})}):e.jsx(e.Fragment,{children:e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-700 dark:text-gray-300",children:"Qtde"}),e.jsx("input",{type:"number",name:"quantity",step:"any",value:r.quantity??1,onChange:x,className:"mt-1 w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-700 dark:text-gray-300",children:"Valor unit."}),e.jsx("input",{type:"number",name:"unitValue",step:"any",value:r.unitValue??0,onChange:x,className:"mt-1 w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-700 dark:text-gray-300",children:"Total"}),e.jsx("input",{type:"number",name:"amount",step:"0.01",value:r.amount,onChange:x,className:"mt-1 w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white font-semibold"})]})]})}),e.jsxs("div",{className:"border rounded-md p-3 bg-gray-50 dark:bg-gray-900/40 space-y-3",children:[e.jsx("p",{className:"text-xs font-semibold text-gray-700 dark:text-gray-200 uppercase",children:"Imposto de Renda / Comprovante"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-700 dark:text-gray-300",children:"Situação do comprovante"}),e.jsxs("div",{className:"mt-1 space-y-1 text-xs",children:[e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",name:"receiptStatus",value:h.NONE,checked:(r.receiptStatus??h.NONE)===h.NONE,onChange:x,className:"form-radio text-indigo-600"}),e.jsx("span",{className:"ml-2 text-gray-700 dark:text-gray-300",children:"Não tenho comprovante"})]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",name:"receiptStatus",value:h.HAS_BUT_NOT_ATTACHED,checked:r.receiptStatus===h.HAS_BUT_NOT_ATTACHED,onChange:x,className:"form-radio text-indigo-600"}),e.jsx("span",{className:"ml-2 text-gray-700 dark:text-gray-300",children:"Tenho, mas ainda não anexei"})]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",name:"receiptStatus",value:h.ATTACHED,checked:r.receiptStatus===h.ATTACHED,onChange:x,className:"form-radio text-indigo-600"}),e.jsx("span",{className:"ml-2 text-gray-700 dark:text-gray-300",children:"Comprovante anexado"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-700 dark:text-gray-300",children:"Categoria IR"}),e.jsxs("select",{name:"irCategory",value:r.irCategory??w.NAO_DEDUTIVEL,onChange:x,className:"mt-1 w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white text-xs",children:[e.jsx("option",{value:w.NAO_DEDUTIVEL,children:"Não dedutível / geral"}),e.jsx("option",{value:w.SAUDE,children:"Saúde (dedutível)"}),e.jsx("option",{value:w.EDUCACAO,children:"Educação (dedutível)"}),e.jsx("option",{value:w.LIVRO_CAIXA,children:"Livro caixa (autônomo)"}),e.jsx("option",{value:w.CARNE_LEAO,children:"Carnê Leão (autônomo)"}),e.jsx("option",{value:w.ALUGUEL,children:"Aluguel"}),e.jsx("option",{value:w.BEM_DIREITO,children:"Bens e direitos"}),e.jsx("option",{value:w.ATIVIDADE_RURAL,children:"Atividade Rural"}),e.jsx("option",{value:w.OUTRA,children:"Outros"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-700 dark:text-gray-300",children:"Observações para IR (opcional)"}),e.jsx("textarea",{name:"irNotes",value:r.irNotes??"",onChange:x,rows:2,className:"mt-1 w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white",placeholder:"Ex.: nome do prestador, número da nota, vínculo com dependente..."})]}),M&&e.jsxs("div",{className:"pt-2 border-t border-gray-200 dark:border-gray-700",children:[e.jsx("label",{className:"text-xs text-gray-700 dark:text-gray-300 block mb-2",children:"Anexar comprovante"}),e.jsx(ve,{transactionId:R,userId:M,currentReceiptUrl:r.receiptUrl,currentReceiptFilename:r.receiptFilename,receiptStatus:r.receiptStatus,onUploadComplete:a=>{p(s=>({...s,receiptUrl:a.url,receiptFilename:a.filename,receiptUploadedAt:a.uploadedAt,receiptStatus:h.ATTACHED}))},onDeleteComplete:()=>{p(a=>({...a,receiptUrl:void 0,receiptFilename:void 0,receiptUploadedAt:void 0,receiptStatus:h.HAS_BUT_NOT_ATTACHED}))},onStatusChange:a=>{p(s=>({...s,receiptStatus:a}))}})]})]}),e.jsxs("div",{className:"border rounded-md p-3 bg-gray-50 dark:bg-gray-900/40 space-y-3",children:[e.jsx("p",{className:"text-xs font-semibold text-gray-700 dark:text-gray-200 uppercase",children:"Parcelamento"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-700 dark:text-gray-300",children:"Número de parcelas"}),e.jsx("input",{type:"number",value:v,onChange:a=>T(Math.max(1,parseInt(a.target.value||"1",10))),className:"mt-1 w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white"})]}),v>1&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-700 dark:text-gray-300",children:"Data da 1ª parcela"}),e.jsx("input",{type:"date",value:D,onChange:a=>q(a.target.value),className:"mt-1 w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white"})]})]})]}),e.jsxs("div",{className:"flex justify-end space-x-2 pt-2",children:[e.jsx("button",{type:"button",onClick:m,className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md text-sm text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700",children:"Cancelar"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-indigo-600 text-white rounded-md text-sm hover:bg-indigo-700",children:"Salvar"})]})]})]})})};export{je as default};
