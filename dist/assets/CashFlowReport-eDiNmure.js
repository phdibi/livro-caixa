import{r as u,j as t,T as I}from"./index-Dj2qBV3V.js";import{r as B,D as M,u as Y,a as T,b as z,c as W,d as K,e as b,s as _,f as X,g as A,h as J,i as V,Z,L as G,j as H,C as q,k as Q,l as v,m as E,n as C,R as U,T as ee}from"./CategoricalChart-DhZrjnYR.js";import{c as ae,r as te,B as re,C as se,X as ne,Y as le,a as O}from"./BarChart-Ce5TWLsP.js";import{L as ie}from"./Legend-bZ0hbfHB.js";function L(e,a){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);a&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function D(e){for(var a=1;a<arguments.length;a++){var r=arguments[a]!=null?arguments[a]:{};a%2?L(Object(r),!0).forEach(function(n){de(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):L(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function de(e,a,r){return(a=oe(a))in e?Object.defineProperty(e,a,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[a]=r,e}function oe(e){var a=ce(e,"string");return typeof a=="symbol"?a:a+""}function ce(e,a){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,a);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(a==="string"?String:Number)(e)}function j(){return j=Object.assign?Object.assign.bind():function(e){for(var a=1;a<arguments.length;a++){var r=arguments[a];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},j.apply(null,arguments)}var xe=(e,a)=>{var r;if(u.isValidElement(e))r=u.cloneElement(e,a);else if(typeof e=="function")r=e(a);else{if(!v(a.x1)||!v(a.y1)||!v(a.x2)||!v(a.y2))return null;r=u.createElement("line",j({},a,{className:"recharts-reference-line-line"}))}return r},ue=(e,a,r,n,i,s)=>{var{x:d,width:m}=s,o=i.y.apply(e,{position:r});if(C(o)||a==="discard"&&!i.y.isInRange(o))return null;var c=[{x:d+m,y:o},{x:d,y:o}];return n==="left"?c.reverse():c},ge=(e,a,r,n,i,s)=>{var{y:d,height:m}=s,o=i.x.apply(e,{position:r});if(C(o)||a==="discard"&&!i.x.isInRange(o))return null;var c=[{x:o,y:d+m},{x:o,y:d}];return n==="top"?c.reverse():c},me=(e,a,r,n)=>{var i=e.map(s=>n.apply(s,{position:r}));return a==="discard"&&i.some(s=>!n.isInRange(s))?null:i},ye=(e,a,r,n,i,s)=>{var{x:d,y:m,segment:o,ifOverflow:c}=s,l=E(d),x=E(m);return x?ue(m,c,r,i,e,a):l?ge(d,c,r,n,e,a):o!=null&&o.length===2?me(o,c,r,e):null};function pe(e){var a=Y();return u.useEffect(()=>(a(T(e)),()=>{a(z(e))})),null}function fe(e){var{xAxisId:a,yAxisId:r,shape:n,className:i,ifOverflow:s}=e,d=W(),m=K(),o=b(p=>_(p,a)),c=b(p=>X(p,r)),l=b(p=>A(p,"xAxis",a,d)),x=b(p=>A(p,"yAxis",r,d)),g=J();if(!m||!g||o==null||c==null||l==null||x==null)return null;var f=ae({x:l,y:x}),h=ye(f,g,e.position,o.orientation,c.orientation,e);if(!h)return null;var[{x:N,y:S},{x:P,y:w}]=h,F=s==="hidden"?"url(#".concat(m,")"):void 0,$=D(D({clipPath:F},V(e)),{},{x1:N,y1:S,x2:P,y2:w}),k=te({x1:N,y1:S,x2:P,y2:w});return u.createElement(Z,{zIndex:e.zIndex},u.createElement(G,{className:H("recharts-reference-line",i)},xe(n,$),u.createElement(q,j({},k,{lowerWidth:k.width,upperWidth:k.width}),u.createElement(Q,{label:e.label}),e.children)))}var he={ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle",zIndex:M.line};function R(e){var a=B(e,he);return u.createElement(u.Fragment,null,u.createElement(pe,{yAxisId:a.yAxisId,xAxisId:a.xAxisId,ifOverflow:a.ifOverflow,x:a.x,y:a.y,segment:a.segment}),u.createElement(fe,a))}R.displayName="ReferenceLine";const y=e=>e.toLocaleString("pt-BR",{style:"currency",currency:"BRL"}),be=e=>{const[a,r,n]=e.split("-").map(Number);return new Date(a,r-1,n,12,0,0)},ve=e=>{const a=new Date(e.getFullYear(),0,1),r=(e.getTime()-a.getTime())/864e5,n=Math.ceil((r+a.getDay()+1)/7);return`${e.getFullYear()}-S${String(n).padStart(2,"0")}`},je=e=>e.type===I.ENTRADA||e.type==="Entrada",ke=e=>e.type===I.SAIDA||e.type==="Saida"||e.type==="Saída",Ae=({transactions:e})=>{const[a,r]=u.useState("month"),n=u.useMemo(()=>{const s=new Map,d=["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"];[...e].sort((l,x)=>l.date.localeCompare(x.date)).forEach(l=>{const x=be(l.date);let g,f;switch(a){case"day":g=l.date,f=x.toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit"});break;case"week":g=ve(x),f=g.replace("-S","/S");break;case"month":default:g=`${x.getFullYear()}-${String(x.getMonth()+1).padStart(2,"0")}`,f=`${d[x.getMonth()]}/${String(x.getFullYear()).slice(-2)}`;break}s.has(g)||s.set(g,{key:g,label:f,entrada:0,saida:0,saldo:0});const h=s.get(g);je(l)?h.entrada+=l.amount:ke(l)&&(h.saida+=l.amount)});const o=Array.from(s.values()).sort((l,x)=>l.key.localeCompare(x.key)).map(l=>({...l,saldo:l.entrada-l.saida}));let c=0;return o.forEach(l=>{c+=l.saldo,l.acumulado=c}),o},[e,a]),i=u.useMemo(()=>n.reduce((s,d)=>({entradas:s.entradas+d.entrada,saidas:s.saidas+d.saida,saldo:s.saldo+d.saldo}),{entradas:0,saidas:0,saldo:0}),[n]);return e.length===0?t.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6 text-center text-gray-500 dark:text-gray-400",children:"Nenhuma transação para exibir o fluxo de caixa."}):t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-4",children:[t.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-4",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-800 dark:text-gray-200",children:"Fluxo de Caixa"}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("label",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Agrupar por:"}),t.jsxs("select",{value:a,onChange:s=>r(s.target.value),className:"px-2 py-1 text-sm border rounded dark:bg-gray-700 dark:border-gray-600",children:[t.jsx("option",{value:"day",children:"Dia"}),t.jsx("option",{value:"week",children:"Semana"}),t.jsx("option",{value:"month",children:"Mês"})]})]})]}),t.jsxs("div",{className:"grid grid-cols-3 gap-2 mb-4",children:[t.jsxs("div",{className:"bg-green-50 dark:bg-green-900/30 p-2 rounded text-center",children:[t.jsx("p",{className:"text-[10px] text-green-600 dark:text-green-400 uppercase",children:"Entradas"}),t.jsx("p",{className:"text-sm font-bold text-green-700 dark:text-green-300",children:y(i.entradas)})]}),t.jsxs("div",{className:"bg-red-50 dark:bg-red-900/30 p-2 rounded text-center",children:[t.jsx("p",{className:"text-[10px] text-red-600 dark:text-red-400 uppercase",children:"Saídas"}),t.jsx("p",{className:"text-sm font-bold text-red-700 dark:text-red-300",children:y(i.saidas)})]}),t.jsxs("div",{className:`p-2 rounded text-center ${i.saldo>=0?"bg-blue-50 dark:bg-blue-900/30":"bg-orange-50 dark:bg-orange-900/30"}`,children:[t.jsx("p",{className:`text-[10px] uppercase ${i.saldo>=0?"text-blue-600 dark:text-blue-400":"text-orange-600 dark:text-orange-400"}`,children:"Saldo"}),t.jsx("p",{className:`text-sm font-bold ${i.saldo>=0?"text-blue-700 dark:text-blue-300":"text-orange-700 dark:text-orange-300"}`,children:y(i.saldo)})]})]}),t.jsx(U,{width:"100%",height:300,children:t.jsxs(re,{data:n,margin:{top:10,right:10,left:0,bottom:0},children:[t.jsx(se,{strokeDasharray:"3 3",stroke:"rgba(128,128,128,0.2)"}),t.jsx(ne,{dataKey:"label",tick:{fontSize:10},stroke:"#9ca3af",interval:a==="day"?"preserveStartEnd":0}),t.jsx(le,{tick:{fontSize:10},stroke:"#9ca3af",tickFormatter:s=>s>=1e3?`${(s/1e3).toFixed(0)}k`:s.toString()}),t.jsx(ee,{contentStyle:{backgroundColor:"#374151",border:"none",fontSize:"12px"},labelStyle:{color:"#d1d5db"},formatter:(s,d)=>[y(s),d==="entrada"?"Entradas":d==="saida"?"Saídas":"Saldo"]}),t.jsx(ie,{formatter:s=>s==="entrada"?"Entradas":s==="saida"?"Saídas":"Saldo"}),t.jsx(R,{y:0,stroke:"#666"}),t.jsx(O,{dataKey:"entrada",fill:"#22c55e",name:"entrada"}),t.jsx(O,{dataKey:"saida",fill:"#ef4444",name:"saida"})]})}),t.jsx("div",{className:"mt-4 max-h-48 overflow-y-auto",children:t.jsxs("table",{className:"w-full text-xs",children:[t.jsx("thead",{className:"bg-gray-50 dark:bg-gray-900/50 sticky top-0",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-2 py-1 text-left text-gray-600 dark:text-gray-400",children:"Período"}),t.jsx("th",{className:"px-2 py-1 text-right text-green-600 dark:text-green-400",children:"Entradas"}),t.jsx("th",{className:"px-2 py-1 text-right text-red-600 dark:text-red-400",children:"Saídas"}),t.jsx("th",{className:"px-2 py-1 text-right text-gray-600 dark:text-gray-400",children:"Saldo"}),t.jsx("th",{className:"px-2 py-1 text-right text-blue-600 dark:text-blue-400",children:"Acumulado"})]})}),t.jsx("tbody",{className:"divide-y divide-gray-100 dark:divide-gray-700",children:n.map(s=>t.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-900/30",children:[t.jsx("td",{className:"px-2 py-1 text-gray-800 dark:text-gray-200",children:s.label}),t.jsx("td",{className:"px-2 py-1 text-right text-green-600 dark:text-green-400",children:y(s.entrada)}),t.jsx("td",{className:"px-2 py-1 text-right text-red-600 dark:text-red-400",children:y(s.saida)}),t.jsx("td",{className:`px-2 py-1 text-right font-medium ${s.saldo>=0?"text-gray-800 dark:text-gray-200":"text-orange-600 dark:text-orange-400"}`,children:y(s.saldo)}),t.jsx("td",{className:`px-2 py-1 text-right ${s.acumulado>=0?"text-blue-600 dark:text-blue-400":"text-orange-600 dark:text-orange-400"}`,children:y(s.acumulado)})]},s.key))})]})})]})};export{Ae as default};
