import{s as $,b as ee,u as le,g as ie,d as ce,r as u,R as h,j as e,I as w,T as G,c as ae,e as _,p as me,h as ue}from"./index-Dj2qBV3V.js";const xe=["image/jpeg","image/png","image/gif","image/webp","application/pdf"],K=10*1024*1024;function te(d){return xe.includes(d.type)?d.size>K?{code:"file-too-large",message:`Arquivo muito grande. Máximo: ${K/1024/1024}MB.`}:null:{code:"invalid-type",message:"Tipo de arquivo não permitido. Use: JPEG, PNG, GIF, WebP ou PDF."}}function ge(d){const c=Date.now(),g=Math.random().toString(36).substring(2,8),r=d.split(".").pop()||"bin";return`${d.replace(/\.[^/.]+$/,"").replace(/[^a-zA-Z0-9]/g,"_").substring(0,50)}_${c}_${g}.${r}`}async function pe(d,c,g){if(!$)throw{code:"storage-not-configured",message:"Firebase Storage não está configurado."};const r=te(d);if(r)throw r;try{const m=ge(d.name),E=`receipts/${c}/${g}/${m}`,M=ee($,E),b=await le(M,d,{contentType:d.type,customMetadata:{originalName:d.name,transactionId:g,uploadedBy:c}});return{url:await ie(b.ref),filename:d.name,uploadedAt:Date.now()}}catch(m){throw console.error("Erro ao fazer upload:",m),{code:"upload-failed",message:"Falha ao enviar arquivo. Tente novamente."}}}async function he(d){if(!(!$||!d))try{const c=ee($,d);await ce(c)}catch(c){console.warn("Erro ao excluir comprovante (pode já ter sido excluído):",c)}}function be(d){var r;const c=["jpg","jpeg","png","gif","webp"],g=((r=d.split(".").pop())==null?void 0:r.toLowerCase())||"";return c.includes(g)}function ye(d){return d.toLowerCase().endsWith(".pdf")}const ke=({transactionId:d,userId:c,currentReceiptUrl:g,currentReceiptFilename:r,receiptStatus:m,onUploadComplete:E,onDeleteComplete:M,onStatusChange:b,disabled:k=!1})=>{const[y,s]=u.useState(!1),[p,C]=u.useState(0),[T,I]=u.useState(null),[q,U]=u.useState(!1),P=u.useRef(null),A=u.useCallback(async i=>{I(null);const v=te(i);if(v){I(v.message);return}s(!0),C(0);try{const f=setInterval(()=>{C(W=>Math.min(W+10,90))},100),O=await pe(i,c,d);clearInterval(f),C(100),E(O),b(h.ATTACHED),setTimeout(()=>{C(0)},500)}catch(f){I(f.message||"Erro ao enviar arquivo")}finally{s(!1)}},[c,d,E,b]),F=i=>{var f;const v=(f=i.target.files)==null?void 0:f[0];v&&A(v),i.target.value=""},R=i=>{i.preventDefault(),!k&&!y&&U(!0)},S=i=>{i.preventDefault(),U(!1)},B=i=>{var f;if(i.preventDefault(),U(!1),k||y)return;const v=(f=i.dataTransfer.files)==null?void 0:f[0];v&&A(v)},x=async()=>{if(!(!g||!window.confirm("Tem certeza que deseja excluir o comprovante?")))try{await he(g),M(),b(h.HAS_BUT_NOT_ATTACHED)}catch{I("Erro ao excluir comprovante")}},V=()=>{g&&window.open(g,"_blank")};return g&&m===h.ATTACHED?e.jsx("div",{className:"border border-green-200 dark:border-green-800 rounded-lg p-3 bg-green-50 dark:bg-green-900/20",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[r&&be(r)?e.jsx("svg",{className:"w-5 h-5 text-green-600 dark:text-green-400 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}):ye(r||"")?e.jsx("svg",{className:"w-5 h-5 text-red-600 dark:text-red-400 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"})}):e.jsx("svg",{className:"w-5 h-5 text-gray-600 dark:text-gray-400 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),e.jsx("span",{className:"text-sm text-green-700 dark:text-green-300 truncate",children:r||"Comprovante anexado"})]}),e.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[e.jsx("button",{onClick:V,className:"p-1.5 text-green-600 hover:bg-green-100 dark:hover:bg-green-800 rounded",title:"Ver comprovante",children:e.jsxs("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})}),!k&&e.jsx("button",{onClick:x,className:"p-1.5 text-red-600 hover:bg-red-100 dark:hover:bg-red-900/40 rounded",title:"Excluir comprovante",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]})}):e.jsxs("div",{className:"space-y-2",children:[e.jsx("input",{ref:P,type:"file",accept:"image/jpeg,image/png,image/gif,image/webp,application/pdf",onChange:F,className:"hidden",disabled:k||y}),e.jsx("div",{onDragOver:R,onDragLeave:S,onDrop:B,onClick:()=>{var i;return!k&&!y&&((i=P.current)==null?void 0:i.click())},className:`
          border-2 border-dashed rounded-lg p-4 text-center cursor-pointer
          transition-colors duration-200
          ${q?"border-indigo-500 bg-indigo-50 dark:bg-indigo-900/20":"border-gray-300 dark:border-gray-600 hover:border-indigo-400 dark:hover:border-indigo-500"}
          ${k||y?"opacity-50 cursor-not-allowed":""}
        `,children:y?e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2",children:e.jsx("div",{className:"bg-indigo-600 h-2 rounded-full transition-all duration-200",style:{width:`${p}%`}})}),e.jsx("p",{className:"text-sm text-gray-500",children:"Enviando..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"mx-auto h-8 w-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),e.jsx("p",{className:"mt-1 text-sm text-gray-600 dark:text-gray-400",children:"Arraste um arquivo ou clique para selecionar"}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-500",children:"JPEG, PNG, GIF, WebP ou PDF (máx. 10MB)"})]})}),T&&e.jsx("p",{className:"text-sm text-red-600 dark:text-red-400",children:T})]})},J=()=>ae(new Date),fe=({isOpen:d,onClose:c,onSave:g,transactionToEdit:r,accounts:m,transactions:E,userId:M})=>{const b=u.useMemo(()=>({number:m.length>0?m[0].number:0,name:m.length>0?m[0].name:""}),[m]),k=u.useCallback(()=>({date:J(),type:G.SAIDA,accountNumber:b.number,accountName:b.name,description:"",quantity:1,unitValue:0,amount:0,payee:"",paymentMethod:"pix",notes:"",receiptStatus:h.NONE,irCategory:w.NAO_DEDUTIVEL,irNotes:"",isContaTiti:!1,receiptUrl:void 0,receiptFilename:void 0,receiptUploadedAt:void 0}),[b]),y=u.useCallback(()=>({id:_(),accountNumber:b.number,accountName:b.name,description:"",quantity:1,unitValue:0,amount:0}),[b]),[s,p]=u.useState(k()),[C,T]=u.useState(1),[I,q]=u.useState(J()),[U,P]=u.useState("single"),[A,F]=u.useState(!1),[R,S]=u.useState([y()]),B=!!(r!=null&&r.seriesId);if(u.useEffect(()=>{if(d)if(r){const a={...k(),...r};if(r.seriesId){const t=E.filter(o=>o.seriesId===r.seriesId);T(t.length||1);const D=[...t].sort((o,j)=>o.date.localeCompare(j.date))[0]??r;q(D.date)}else T(1),q(r.date);p(a);const n=r.items;n&&n.length>0?(F(!0),S(n.map(t=>({id:t.id||_(),accountNumber:t.accountNumber,accountName:t.accountName,description:t.description,quantity:t.quantity,unitValue:t.unitValue,amount:t.amount})))):(F(!1),S([y()]))}else{const a=k();p(a),T(1),q(a.date),P("single"),F(!1),S([y()])}},[d,r,E,m]),u.useEffect(()=>{var t;if(A)return;const a=s.quantity||0,n=s.unitValue||0;((t=document.activeElement)==null?void 0:t.getAttribute("name"))!=="amount"&&p(L=>({...L,amount:a*n}))},[s.quantity,s.unitValue,A]),!d)return null;const x=a=>{const{name:n,value:t}=a.target,L=a.target.checked;if(n==="isContaTiti"){p(o=>({...o,isContaTiti:L}));return}if(n==="accountNumber"){const o=parseInt(t,10),j=m.find(l=>l.number===o);p(l=>({...l,accountNumber:o,accountName:(j==null?void 0:j.name)||""}));return}if(n==="receiptStatus"){p(o=>({...o,receiptStatus:t}));return}if(n==="irCategory"){p(o=>({...o,irCategory:t}));return}let D=t;["amount","quantity","unitValue"].includes(n)&&(D=parseFloat(t)||0),p(o=>({...o,[n]:D}))},V=(a,n,t)=>{S(L=>L.map(D=>{if(D.id!==a)return D;const o={...D};switch(n){case"accountNumber":{const j=parseInt(t,10),l=m.find(N=>N.number===j);o.accountNumber=j,o.accountName=(l==null?void 0:l.name)||"";break}case"quantity":o.quantity=parseFloat(t)||0;break;case"unitValue":o.unitValue=parseFloat(t)||0;break;case"amount":o.amount=parseFloat(t)||0;break;case"description":o.description=String(t);break}return(n==="quantity"||n==="unitValue")&&(o.amount=o.quantity*o.unitValue),o}))},i=()=>S(a=>[...a,y()]),v=a=>S(n=>n.length===1?[y()]:n.filter(t=>t.id!==a)),f=a=>{if(a.preventDefault(),A&&!B){const t=R.filter(l=>l.description.trim()!==""||l.amount>0);if(t.length===0){alert("Adicione pelo menos um item na nota.");return}const L=_(),o=C>1&&I||s.date||J(),j=me(o);if(Number.isNaN(j.getTime())){alert("Data da 1ª parcela inválida. Verifique o campo de data do lançamento.");return}t.forEach(l=>{const N=Math.max(1,C),Q=N>1?_():void 0,re=typeof l.amount=="number"&&!isNaN(l.amount)?l.amount:(l.quantity||0)*(l.unitValue||0),z=Math.round(re*100),X=N>0?Math.floor(z/N):z;let se=z-X*N;for(let H=0;H<N;H++){const ne=ue(j,H);let Z=X;H===N-1&&(Z+=se);const oe=Z/100,Y={...s,id:_(),date:ae(ne),accountNumber:l.accountNumber,accountName:l.accountName,description:N>1?`${l.description} (${H+1}/${N})`:l.description,quantity:l.quantity,unitValue:l.unitValue,amount:oe,invoiceId:L},de=N>1&&Q?{...Y,seriesId:Q}:Y;g({transaction:de,installmentsCount:1})}}),c();return}const n={...s,id:(r==null?void 0:r.id)||_(),date:s.date};g({transaction:n,updateScope:B?U:void 0,installmentsCount:C,firstInstallmentDate:I}),c()},O=!B,W=R.reduce((a,n)=>a+n.amount,0);return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-start sm:items-center p-2 sm:p-4 overflow-y-auto",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl w-full max-w-2xl p-4 sm:p-6 my-4 sm:my-8",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-900 dark:text-white",children:[r?"Editar":"Adicionar"," Lançamento"]}),e.jsxs("label",{className:"flex items-center text-xs sm:text-sm text-gray-700 dark:text-gray-300",children:[e.jsx("input",{type:"checkbox",checked:A,onChange:a=>F(a.target.checked&&O),disabled:!O,className:"mr-2"}),"Modo nota fiscal"]})]}),e.jsx("div",{className:"mb-4",children:e.jsxs("label",{className:"flex items-center text-sm font-medium text-amber-600 dark:text-amber-400",children:[e.jsx("input",{type:"checkbox",name:"isContaTiti",checked:!!s.isContaTiti,onChange:x,className:"mr-2 rounded border-gray-300 text-amber-600 shadow-sm focus:border-amber-300 focus:ring focus:ring-amber-200 focus:ring-opacity-50"}),"Conta Titi (Ocultar do fluxo/gráficos)"]})}),e.jsxs("form",{onSubmit:f,className:"space-y-4 max-h-[80vh] overflow-y-auto pr-1",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-700 dark:text-gray-300",children:"Data"}),e.jsx("input",{type:"date",name:"date",value:s.date,onChange:x,className:"mt-1 w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-700 dark:text-gray-300",children:"Tipo"}),e.jsxs("select",{name:"type",value:s.type,onChange:x,className:"mt-1 w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white",children:[e.jsx("option",{value:G.ENTRADA,children:"Entrada"}),e.jsx("option",{value:G.SAIDA,children:"Saída"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-700 dark:text-gray-300",children:"Fornecedor/Comprador"}),e.jsx("input",{type:"text",name:"payee",value:s.payee,onChange:x,placeholder:"Nome do fornecedor ou comprador",className:"mt-1 w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white"})]}),!A&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-700 dark:text-gray-300",children:"Conta"}),e.jsx("select",{name:"accountNumber",value:s.accountNumber,onChange:x,className:"mt-1 w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white",children:m.map(a=>e.jsxs("option",{value:a.number,children:[a.number," - ",a.name]},a.id))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-700 dark:text-gray-300",children:"Histórico"}),e.jsx("input",{type:"text",name:"description",value:s.description,onChange:x,className:"mt-1 w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white"})]})]}),A?e.jsx(e.Fragment,{children:e.jsxs("div",{className:"border-2 border-amber-400 dark:border-amber-600 rounded-md p-3 bg-amber-50 dark:bg-amber-900/20 space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsxs("p",{className:"text-xs font-semibold text-amber-700 dark:text-amber-300 uppercase flex items-center",children:[e.jsx("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Itens da Nota Fiscal"]}),e.jsxs("span",{className:"text-xs text-amber-600 dark:text-amber-400",children:["Total:"," ",e.jsx("strong",{children:W.toLocaleString("pt-BR",{style:"currency",currency:"BRL"})})]})]}),R.map((a,n)=>e.jsxs("div",{className:"border rounded-md p-2 mb-2 bg-white dark:bg-gray-800",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsxs("span",{className:"text-xs font-medium text-gray-500 dark:text-gray-400",children:["Item ",n+1]}),e.jsx("button",{type:"button",onClick:()=>v(a.id),className:"text-xs text-red-600 dark:text-red-400 hover:text-red-800",children:"Remover"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2 mb-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-700 dark:text-gray-300",children:"Conta"}),e.jsx("select",{value:a.accountNumber,onChange:t=>V(a.id,"accountNumber",t.target.value),className:"mt-1 w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white text-sm",children:m.map(t=>e.jsxs("option",{value:t.number,children:[t.number," - ",t.name]},t.id))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-700 dark:text-gray-300",children:"Descrição do item"}),e.jsx("input",{type:"text",value:a.description,onChange:t=>V(a.id,"description",t.target.value),placeholder:"Ex: Ração, Medicamento...",className:"mt-1 w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white text-sm"})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-700 dark:text-gray-300",children:"Qtde"}),e.jsx("input",{type:"number",step:"any",value:a.quantity,onChange:t=>V(a.id,"quantity",t.target.value),className:"mt-1 w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-700 dark:text-gray-300",children:"Valor unit."}),e.jsx("input",{type:"number",step:"any",value:a.unitValue,onChange:t=>V(a.id,"unitValue",t.target.value),className:"mt-1 w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-700 dark:text-gray-300",children:"Valor total"}),e.jsx("input",{type:"number",step:"any",value:a.amount,onChange:t=>V(a.id,"amount",t.target.value),className:"mt-1 w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white text-sm font-semibold"})]})]})]},a.id)),e.jsxs("button",{type:"button",onClick:i,className:"text-sm text-amber-700 dark:text-amber-400 hover:text-amber-900 flex items-center",children:[e.jsx("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Adicionar item"]})]})}):e.jsx(e.Fragment,{children:e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-700 dark:text-gray-300",children:"Qtde"}),e.jsx("input",{type:"number",name:"quantity",step:"any",value:s.quantity??1,onChange:x,className:"mt-1 w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-700 dark:text-gray-300",children:"Valor unit."}),e.jsx("input",{type:"number",name:"unitValue",step:"any",value:s.unitValue??0,onChange:x,className:"mt-1 w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-700 dark:text-gray-300",children:"Total"}),e.jsx("input",{type:"number",name:"amount",step:"0.01",value:s.amount,onChange:x,className:"mt-1 w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white font-semibold"})]})]})}),e.jsxs("div",{className:"border rounded-md p-3 bg-gray-50 dark:bg-gray-900/40 space-y-3",children:[e.jsx("p",{className:"text-xs font-semibold text-gray-700 dark:text-gray-200 uppercase",children:"Imposto de Renda / Comprovante"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-700 dark:text-gray-300",children:"Situação do comprovante"}),e.jsxs("div",{className:"mt-1 space-y-1 text-xs",children:[e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",name:"receiptStatus",value:h.NONE,checked:(s.receiptStatus??h.NONE)===h.NONE,onChange:x,className:"form-radio text-indigo-600"}),e.jsx("span",{className:"ml-2 text-gray-700 dark:text-gray-300",children:"Não tenho comprovante"})]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",name:"receiptStatus",value:h.HAS_BUT_NOT_ATTACHED,checked:s.receiptStatus===h.HAS_BUT_NOT_ATTACHED,onChange:x,className:"form-radio text-indigo-600"}),e.jsx("span",{className:"ml-2 text-gray-700 dark:text-gray-300",children:"Tenho, mas ainda não anexei"})]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",name:"receiptStatus",value:h.ATTACHED,checked:s.receiptStatus===h.ATTACHED,onChange:x,className:"form-radio text-indigo-600"}),e.jsx("span",{className:"ml-2 text-gray-700 dark:text-gray-300",children:"Comprovante anexado"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-700 dark:text-gray-300",children:"Categoria IR"}),e.jsxs("select",{name:"irCategory",value:s.irCategory??w.NAO_DEDUTIVEL,onChange:x,className:"mt-1 w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white text-xs",children:[e.jsx("option",{value:w.NAO_DEDUTIVEL,children:"Não dedutível / geral"}),e.jsx("option",{value:w.SAUDE,children:"Saúde (dedutível)"}),e.jsx("option",{value:w.EDUCACAO,children:"Educação (dedutível)"}),e.jsx("option",{value:w.LIVRO_CAIXA,children:"Livro caixa (autônomo)"}),e.jsx("option",{value:w.CARNE_LEAO,children:"Carnê Leão (autônomo)"}),e.jsx("option",{value:w.ALUGUEL,children:"Aluguel"}),e.jsx("option",{value:w.BEM_DIREITO,children:"Bens e direitos"}),e.jsx("option",{value:w.ATIVIDADE_RURAL,children:"Atividade Rural"}),e.jsx("option",{value:w.OUTRA,children:"Outros"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-700 dark:text-gray-300",children:"Observações para IR (opcional)"}),e.jsx("textarea",{name:"irNotes",value:s.irNotes??"",onChange:x,rows:2,className:"mt-1 w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white",placeholder:"Ex.: nome do prestador, número da nota, vínculo com dependente..."})]}),r&&M&&e.jsxs("div",{className:"pt-2 border-t border-gray-200 dark:border-gray-700",children:[e.jsx("label",{className:"text-xs text-gray-700 dark:text-gray-300 block mb-2",children:"Anexar comprovante"}),e.jsx(ke,{transactionId:r.id,userId:M,currentReceiptUrl:s.receiptUrl,currentReceiptFilename:s.receiptFilename,receiptStatus:s.receiptStatus,onUploadComplete:a=>{p(n=>({...n,receiptUrl:a.url,receiptFilename:a.filename,receiptUploadedAt:a.uploadedAt,receiptStatus:h.ATTACHED}))},onDeleteComplete:()=>{p(a=>({...a,receiptUrl:void 0,receiptFilename:void 0,receiptUploadedAt:void 0,receiptStatus:h.HAS_BUT_NOT_ATTACHED}))},onStatusChange:a=>{p(n=>({...n,receiptStatus:a}))}})]})]}),e.jsxs("div",{className:"border rounded-md p-3 bg-gray-50 dark:bg-gray-900/40 space-y-3",children:[e.jsx("p",{className:"text-xs font-semibold text-gray-700 dark:text-gray-200 uppercase",children:"Parcelamento"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-700 dark:text-gray-300",children:"Número de parcelas"}),e.jsx("input",{type:"number",value:C,onChange:a=>T(Math.max(1,parseInt(a.target.value||"1",10))),className:"mt-1 w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white"})]}),C>1&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-700 dark:text-gray-300",children:"Data da 1ª parcela"}),e.jsx("input",{type:"date",value:I,onChange:a=>q(a.target.value),className:"mt-1 w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white"})]})]})]}),e.jsxs("div",{className:"flex justify-end space-x-2 pt-2",children:[e.jsx("button",{type:"button",onClick:c,className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md text-sm text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700",children:"Cancelar"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-indigo-600 text-white rounded-md text-sm hover:bg-indigo-700",children:"Salvar"})]})]})]})})};export{fe as default};
