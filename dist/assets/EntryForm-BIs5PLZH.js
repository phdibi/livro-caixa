import{s as $,b as ee,u as ie,g as ce,d as ue,r as m,R as y,j as e,I as A,T as G,c as ae,e as F,p as me,h as xe}from"./index-Dj5H05TC.js";const ge=["image/jpeg","image/png","image/gif","image/webp","application/pdf"],K=10*1024*1024;function te(r){return ge.includes(r.type)?r.size>K?{code:"file-too-large",message:`Arquivo muito grande. Máximo: ${K/1024/1024}MB.`}:null:{code:"invalid-type",message:"Tipo de arquivo não permitido. Use: JPEG, PNG, GIF, WebP ou PDF."}}function pe(r){const c=Date.now(),g=Math.random().toString(36).substring(2,8),o=r.split(".").pop()||"bin";return`${r.replace(/\.[^/.]+$/,"").replace(/[^a-zA-Z0-9]/g,"_").substring(0,50)}_${c}_${g}.${o}`}async function he(r,c,g){if(!$)throw{code:"storage-not-configured",message:"Firebase Storage não está configurado."};const o=te(r);if(o)throw o;try{const u=pe(r.name),p=`receipts/${c}/${g}/${u}`,h=ee($,p),k=await ie(h,r,{contentType:r.type,customMetadata:{originalName:r.name,transactionId:g,uploadedBy:c}});return{url:await ce(k.ref),filename:r.name,uploadedAt:Date.now()}}catch(u){console.error("Erro ao fazer upload:",u);let p="Falha ao enviar arquivo. Tente novamente.";if(u&&typeof u=="object"){const h=u;h.code==="storage/unauthorized"?p="Sem permissão para fazer upload. Verifique as regras do Firebase Storage.":h.code==="storage/canceled"?p="Upload cancelado.":h.code==="storage/unknown"?p="Erro desconhecido no upload. Verifique sua conexão.":h.code==="storage/quota-exceeded"?p="Cota de armazenamento excedida.":h.code==="storage/unauthenticated"?p="Usuário não autenticado. Faça login novamente.":h.message&&(p=h.message)}throw{code:"upload-failed",message:p}}}async function be(r){if(!(!$||!r))try{const c=ee($,r);await ue(c)}catch(c){console.warn("Erro ao excluir comprovante (pode já ter sido excluído):",c)}}function ye(r){var o;const c=["jpg","jpeg","png","gif","webp"],g=((o=r.split(".").pop())==null?void 0:o.toLowerCase())||"";return c.includes(g)}function ke(r){return r.toLowerCase().endsWith(".pdf")}const fe=({transactionId:r,userId:c,currentReceiptUrl:g,currentReceiptFilename:o,receiptStatus:u,onUploadComplete:p,onDeleteComplete:h,onStatusChange:k,disabled:v=!1})=>{const[f,s]=m.useState(!1),[b,j]=m.useState(0),[M,S]=m.useState(null),[q,_]=m.useState(!1),P=m.useRef(null),R=m.useCallback(async l=>{if(S(null),!c||!r){S("Erro interno: ID do usuário ou transação não disponível."),console.error("Upload falhou: userId ou transactionId não definido",{userId:c,transactionId:r});return}const N=te(l);if(N){S(N.message);return}s(!0),j(0);const D=setInterval(()=>{j(T=>Math.min(T+10,90))},100);try{console.log("Iniciando upload:",{fileName:l.name,userId:c,transactionId:r});const T=await he(l,c,r);console.log("Upload concluído com sucesso:",T),clearInterval(D),j(100),p(T),k(y.ATTACHED),setTimeout(()=>{j(0)},500)}catch(T){clearInterval(D),j(0),S(T.message||"Erro ao enviar arquivo")}finally{s(!1)}},[c,r,p,k]),E=l=>{var D;const N=(D=l.target.files)==null?void 0:D[0];N&&R(N),l.target.value=""},U=l=>{l.preventDefault(),!v&&!f&&_(!0)},B=l=>{l.preventDefault(),_(!1)},L=l=>{var D;if(l.preventDefault(),_(!1),v||f)return;const N=(D=l.dataTransfer.files)==null?void 0:D[0];N&&R(N)},O=async()=>{if(!(!g||!window.confirm("Tem certeza que deseja excluir o comprovante?")))try{await be(g),h(),k(y.HAS_BUT_NOT_ATTACHED)}catch{S("Erro ao excluir comprovante")}},x=()=>{g&&window.open(g,"_blank")};return g&&u===y.ATTACHED?e.jsx("div",{className:"border border-green-200 dark:border-green-800 rounded-lg p-3 bg-green-50 dark:bg-green-900/20",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[o&&ye(o)?e.jsx("svg",{className:"w-5 h-5 text-green-600 dark:text-green-400 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}):ke(o||"")?e.jsx("svg",{className:"w-5 h-5 text-red-600 dark:text-red-400 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"})}):e.jsx("svg",{className:"w-5 h-5 text-gray-600 dark:text-gray-400 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),e.jsx("span",{className:"text-sm text-green-700 dark:text-green-300 truncate",children:o||"Comprovante anexado"})]}),e.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[e.jsx("button",{onClick:x,className:"p-1.5 text-green-600 hover:bg-green-100 dark:hover:bg-green-800 rounded",title:"Ver comprovante",children:e.jsxs("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})}),!v&&e.jsx("button",{onClick:O,className:"p-1.5 text-red-600 hover:bg-red-100 dark:hover:bg-red-900/40 rounded",title:"Excluir comprovante",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]})}):e.jsxs("div",{className:"space-y-2",children:[e.jsx("input",{ref:P,type:"file",accept:"image/jpeg,image/png,image/gif,image/webp,application/pdf",onChange:E,className:"hidden",disabled:v||f}),e.jsx("div",{onDragOver:U,onDragLeave:B,onDrop:L,onClick:()=>{var l;return!v&&!f&&((l=P.current)==null?void 0:l.click())},className:`
          border-2 border-dashed rounded-lg p-4 text-center cursor-pointer
          transition-colors duration-200
          ${q?"border-indigo-500 bg-indigo-50 dark:bg-indigo-900/20":"border-gray-300 dark:border-gray-600 hover:border-indigo-400 dark:hover:border-indigo-500"}
          ${v||f?"opacity-50 cursor-not-allowed":""}
        `,children:f?e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2",children:e.jsx("div",{className:"bg-indigo-600 h-2 rounded-full transition-all duration-200",style:{width:`${b}%`}})}),e.jsx("p",{className:"text-sm text-gray-500",children:"Enviando..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"mx-auto h-8 w-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),e.jsx("p",{className:"mt-1 text-sm text-gray-600 dark:text-gray-400",children:"Arraste um arquivo ou clique para selecionar"}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-500",children:"JPEG, PNG, GIF, WebP ou PDF (máx. 10MB)"})]})}),M&&e.jsx("p",{className:"text-sm text-red-600 dark:text-red-400",children:M})]})},J=()=>ae(new Date),je=({isOpen:r,onClose:c,onSave:g,transactionToEdit:o,accounts:u,transactions:p,userId:h})=>{const k=m.useMemo(()=>({number:u.length>0?u[0].number:0,name:u.length>0?u[0].name:""}),[u]),v=m.useCallback(()=>({date:J(),type:G.SAIDA,accountNumber:k.number,accountName:k.name,description:"",quantity:1,unitValue:0,amount:0,payee:"",paymentMethod:"pix",notes:"",receiptStatus:y.NONE,irCategory:A.NAO_DEDUTIVEL,irNotes:"",isContaTiti:!1,receiptUrl:void 0,receiptFilename:void 0,receiptUploadedAt:void 0}),[k]),f=m.useCallback(()=>({id:F(),accountNumber:k.number,accountName:k.name,description:"",quantity:1,unitValue:0,amount:0}),[k]),[s,b]=m.useState(v()),[j,M]=m.useState(1),[S,q]=m.useState(J()),[_,P]=m.useState("single"),[R]=m.useState((o==null?void 0:o.id)||F()),[E,U]=m.useState(!1),[B,L]=m.useState([f()]),O=!!(o!=null&&o.seriesId);if(m.useEffect(()=>{if(r)if(o){const a={...v(),...o};if((!a.unitValue||a.unitValue===0)&&a.amount>0&&(a.quantity=1,a.unitValue=a.amount),o.seriesId){const t=p.filter(d=>d.seriesId===o.seriesId);M(t.length||1);const I=[...t].sort((d,w)=>d.date.localeCompare(w.date))[0]??o;q(I.date)}else M(1),q(o.date);b(a);const n=o.items;n&&n.length>0?(U(!0),L(n.map(t=>({id:t.id||F(),accountNumber:t.accountNumber,accountName:t.accountName,description:t.description,quantity:t.quantity,unitValue:t.unitValue,amount:t.amount})))):(U(!1),L([f()]))}else{const a=v();b(a),M(1),q(a.date),P("single"),U(!1),L([f()])}},[r,o,p,u]),m.useEffect(()=>{var t;if(E)return;const a=s.quantity||0,n=s.unitValue||0;((t=document.activeElement)==null?void 0:t.getAttribute("name"))!=="amount"&&b(V=>({...V,amount:a*n}))},[s.quantity,s.unitValue,E]),!r)return null;const x=a=>{const{name:n,value:t}=a.target,V=a.target.checked;if(n==="isContaTiti"){b(d=>({...d,isContaTiti:V}));return}if(n==="accountNumber"){const d=parseInt(t,10),w=u.find(i=>i.number===d);b(i=>({...i,accountNumber:d,accountName:(w==null?void 0:w.name)||""}));return}if(n==="receiptStatus"){b(d=>({...d,receiptStatus:t}));return}if(n==="irCategory"){b(d=>({...d,irCategory:t}));return}let I=t;["amount","quantity","unitValue"].includes(n)&&(I=parseFloat(t)||0),b(d=>({...d,[n]:I}))},l=(a,n,t)=>{L(V=>V.map(I=>{if(I.id!==a)return I;const d={...I};switch(n){case"accountNumber":{const w=parseInt(t,10),i=u.find(C=>C.number===w);d.accountNumber=w,d.accountName=(i==null?void 0:i.name)||"";break}case"quantity":d.quantity=parseFloat(t)||0;break;case"unitValue":d.unitValue=parseFloat(t)||0;break;case"amount":d.amount=parseFloat(t)||0;break;case"description":d.description=String(t);break}return(n==="quantity"||n==="unitValue")&&(d.amount=d.quantity*d.unitValue),d}))},N=()=>L(a=>[...a,f()]),D=a=>L(n=>n.length===1?[f()]:n.filter(t=>t.id!==a)),T=a=>{if(a.preventDefault(),E&&!O){const t=B.filter(i=>i.description.trim()!==""||i.amount>0);if(t.length===0){alert("Adicione pelo menos um item na nota.");return}const V=F(),d=j>1&&S||s.date||J(),w=me(d);if(Number.isNaN(w.getTime())){alert("Data da 1ª parcela inválida. Verifique o campo de data do lançamento.");return}t.forEach(i=>{const C=Math.max(1,j),Q=C>1?F():void 0,se=typeof i.amount=="number"&&!isNaN(i.amount)?i.amount:(i.quantity||0)*(i.unitValue||0),W=Math.round(se*100),X=C>0?Math.floor(W/C):W;let ne=W-X*C;for(let H=0;H<C;H++){const oe=xe(w,H);let Z=X;H===C-1&&(Z+=ne);const de=Z/100,Y={...s,id:F(),date:ae(oe),accountNumber:i.accountNumber,accountName:i.accountName,description:C>1?`${i.description} (${H+1}/${C})`:i.description,quantity:i.quantity,unitValue:i.unitValue,amount:de,invoiceId:V},le=C>1&&Q?{...Y,seriesId:Q}:Y;g({transaction:le,installmentsCount:1})}}),c();return}const n={...s,id:R,date:s.date};g({transaction:n,updateScope:O?_:void 0,installmentsCount:j,firstInstallmentDate:S}),c()},z=!O,re=B.reduce((a,n)=>a+n.amount,0);return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-start sm:items-center p-2 sm:p-4 overflow-y-auto",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl w-full max-w-2xl p-4 sm:p-6 my-4 sm:my-8",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-900 dark:text-white",children:[o?"Editar":"Adicionar"," Lançamento"]}),e.jsxs("label",{className:"flex items-center text-xs sm:text-sm text-gray-700 dark:text-gray-300",children:[e.jsx("input",{type:"checkbox",checked:E,onChange:a=>U(a.target.checked&&z),disabled:!z,className:"mr-2"}),"Modo nota fiscal"]})]}),e.jsx("div",{className:"mb-4",children:e.jsxs("label",{className:"flex items-center text-sm font-medium text-amber-600 dark:text-amber-400",children:[e.jsx("input",{type:"checkbox",name:"isContaTiti",checked:!!s.isContaTiti,onChange:x,className:"mr-2 rounded border-gray-300 text-amber-600 shadow-sm focus:border-amber-300 focus:ring focus:ring-amber-200 focus:ring-opacity-50"}),"Conta Titi (Ocultar do fluxo/gráficos)"]})}),e.jsxs("form",{onSubmit:T,className:"space-y-4 max-h-[80vh] overflow-y-auto pr-1",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-700 dark:text-gray-300",children:"Data"}),e.jsx("input",{type:"date",name:"date",value:s.date,onChange:x,className:"mt-1 w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-700 dark:text-gray-300",children:"Tipo"}),e.jsxs("select",{name:"type",value:s.type,onChange:x,className:"mt-1 w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white",children:[e.jsx("option",{value:G.ENTRADA,children:"Entrada"}),e.jsx("option",{value:G.SAIDA,children:"Saída"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-700 dark:text-gray-300",children:"Fornecedor/Comprador"}),e.jsx("input",{type:"text",name:"payee",value:s.payee,onChange:x,placeholder:"Nome do fornecedor ou comprador",className:"mt-1 w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white"})]}),!E&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-700 dark:text-gray-300",children:"Conta"}),e.jsx("select",{name:"accountNumber",value:s.accountNumber,onChange:x,className:"mt-1 w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white",children:u.map(a=>e.jsxs("option",{value:a.number,children:[a.number," - ",a.name]},a.id))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-700 dark:text-gray-300",children:"Histórico"}),e.jsx("input",{type:"text",name:"description",value:s.description,onChange:x,className:"mt-1 w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white"})]})]}),E?e.jsx(e.Fragment,{children:e.jsxs("div",{className:"border-2 border-amber-400 dark:border-amber-600 rounded-md p-3 bg-amber-50 dark:bg-amber-900/20 space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsxs("p",{className:"text-xs font-semibold text-amber-700 dark:text-amber-300 uppercase flex items-center",children:[e.jsx("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Itens da Nota Fiscal"]}),e.jsxs("span",{className:"text-xs text-amber-600 dark:text-amber-400",children:["Total:"," ",e.jsx("strong",{children:re.toLocaleString("pt-BR",{style:"currency",currency:"BRL"})})]})]}),B.map((a,n)=>e.jsxs("div",{className:"border rounded-md p-2 mb-2 bg-white dark:bg-gray-800",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsxs("span",{className:"text-xs font-medium text-gray-500 dark:text-gray-400",children:["Item ",n+1]}),e.jsx("button",{type:"button",onClick:()=>D(a.id),className:"text-xs text-red-600 dark:text-red-400 hover:text-red-800",children:"Remover"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2 mb-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-700 dark:text-gray-300",children:"Conta"}),e.jsx("select",{value:a.accountNumber,onChange:t=>l(a.id,"accountNumber",t.target.value),className:"mt-1 w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white text-sm",children:u.map(t=>e.jsxs("option",{value:t.number,children:[t.number," - ",t.name]},t.id))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-700 dark:text-gray-300",children:"Descrição do item"}),e.jsx("input",{type:"text",value:a.description,onChange:t=>l(a.id,"description",t.target.value),placeholder:"Ex: Ração, Medicamento...",className:"mt-1 w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white text-sm"})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-700 dark:text-gray-300",children:"Qtde"}),e.jsx("input",{type:"number",step:"any",value:a.quantity,onChange:t=>l(a.id,"quantity",t.target.value),className:"mt-1 w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-700 dark:text-gray-300",children:"Valor unit."}),e.jsx("input",{type:"number",step:"any",value:a.unitValue,onChange:t=>l(a.id,"unitValue",t.target.value),className:"mt-1 w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-700 dark:text-gray-300",children:"Valor total"}),e.jsx("input",{type:"number",step:"any",value:a.amount,onChange:t=>l(a.id,"amount",t.target.value),className:"mt-1 w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white text-sm font-semibold"})]})]})]},a.id)),e.jsxs("button",{type:"button",onClick:N,className:"text-sm text-amber-700 dark:text-amber-400 hover:text-amber-900 flex items-center",children:[e.jsx("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Adicionar item"]})]})}):e.jsx(e.Fragment,{children:e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-700 dark:text-gray-300",children:"Qtde"}),e.jsx("input",{type:"number",name:"quantity",step:"any",value:s.quantity??1,onChange:x,className:"mt-1 w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-700 dark:text-gray-300",children:"Valor unit."}),e.jsx("input",{type:"number",name:"unitValue",step:"any",value:s.unitValue??0,onChange:x,className:"mt-1 w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-700 dark:text-gray-300",children:"Total"}),e.jsx("input",{type:"number",name:"amount",step:"0.01",value:s.amount,onChange:x,className:"mt-1 w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white font-semibold"})]})]})}),e.jsxs("div",{className:"border rounded-md p-3 bg-gray-50 dark:bg-gray-900/40 space-y-3",children:[e.jsx("p",{className:"text-xs font-semibold text-gray-700 dark:text-gray-200 uppercase",children:"Imposto de Renda / Comprovante"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-700 dark:text-gray-300",children:"Situação do comprovante"}),e.jsxs("div",{className:"mt-1 space-y-1 text-xs",children:[e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",name:"receiptStatus",value:y.NONE,checked:(s.receiptStatus??y.NONE)===y.NONE,onChange:x,className:"form-radio text-indigo-600"}),e.jsx("span",{className:"ml-2 text-gray-700 dark:text-gray-300",children:"Não tenho comprovante"})]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",name:"receiptStatus",value:y.HAS_BUT_NOT_ATTACHED,checked:s.receiptStatus===y.HAS_BUT_NOT_ATTACHED,onChange:x,className:"form-radio text-indigo-600"}),e.jsx("span",{className:"ml-2 text-gray-700 dark:text-gray-300",children:"Tenho, mas ainda não anexei"})]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",name:"receiptStatus",value:y.ATTACHED,checked:s.receiptStatus===y.ATTACHED,onChange:x,className:"form-radio text-indigo-600"}),e.jsx("span",{className:"ml-2 text-gray-700 dark:text-gray-300",children:"Comprovante anexado"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-700 dark:text-gray-300",children:"Categoria IR"}),e.jsxs("select",{name:"irCategory",value:s.irCategory??A.NAO_DEDUTIVEL,onChange:x,className:"mt-1 w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white text-xs",children:[e.jsx("option",{value:A.NAO_DEDUTIVEL,children:"Não dedutível / geral"}),e.jsx("option",{value:A.SAUDE,children:"Saúde (dedutível)"}),e.jsx("option",{value:A.EDUCACAO,children:"Educação (dedutível)"}),e.jsx("option",{value:A.LIVRO_CAIXA,children:"Livro caixa (autônomo)"}),e.jsx("option",{value:A.CARNE_LEAO,children:"Carnê Leão (autônomo)"}),e.jsx("option",{value:A.ALUGUEL,children:"Aluguel"}),e.jsx("option",{value:A.BEM_DIREITO,children:"Bens e direitos"}),e.jsx("option",{value:A.ATIVIDADE_RURAL,children:"Atividade Rural"}),e.jsx("option",{value:A.OUTRA,children:"Outros"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-700 dark:text-gray-300",children:"Observações para IR (opcional)"}),e.jsx("textarea",{name:"irNotes",value:s.irNotes??"",onChange:x,rows:2,className:"mt-1 w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white",placeholder:"Ex.: nome do prestador, número da nota, vínculo com dependente..."})]}),h&&e.jsxs("div",{className:"pt-2 border-t border-gray-200 dark:border-gray-700",children:[e.jsx("label",{className:"text-xs text-gray-700 dark:text-gray-300 block mb-2",children:"Anexar comprovante"}),e.jsx(fe,{transactionId:R,userId:h,currentReceiptUrl:s.receiptUrl,currentReceiptFilename:s.receiptFilename,receiptStatus:s.receiptStatus,onUploadComplete:a=>{b(n=>({...n,receiptUrl:a.url,receiptFilename:a.filename,receiptUploadedAt:a.uploadedAt,receiptStatus:y.ATTACHED}))},onDeleteComplete:()=>{b(a=>({...a,receiptUrl:void 0,receiptFilename:void 0,receiptUploadedAt:void 0,receiptStatus:y.HAS_BUT_NOT_ATTACHED}))},onStatusChange:a=>{b(n=>({...n,receiptStatus:a}))}})]})]}),e.jsxs("div",{className:"border rounded-md p-3 bg-gray-50 dark:bg-gray-900/40 space-y-3",children:[e.jsx("p",{className:"text-xs font-semibold text-gray-700 dark:text-gray-200 uppercase",children:"Parcelamento"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-700 dark:text-gray-300",children:"Número de parcelas"}),e.jsx("input",{type:"number",value:j,onChange:a=>M(Math.max(1,parseInt(a.target.value||"1",10))),className:"mt-1 w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white"})]}),j>1&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-700 dark:text-gray-300",children:"Data da 1ª parcela"}),e.jsx("input",{type:"date",value:S,onChange:a=>q(a.target.value),className:"mt-1 w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white"})]})]})]}),e.jsxs("div",{className:"flex justify-end space-x-2 pt-2",children:[e.jsx("button",{type:"button",onClick:c,className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md text-sm text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700",children:"Cancelar"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-indigo-600 text-white rounded-md text-sm hover:bg-indigo-700",children:"Salvar"})]})]})]})})};export{je as default};
